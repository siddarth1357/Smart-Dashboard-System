{"ast":null,"code":"// src/utils/rbac.js\n\nexport const roles = {\n  SUPER_ADMIN: ['*'],\n  // Full access to everything\n  ADMIN: ['*'],\n  // Full access to everything\n  MANAGER: ['dashboard', 'users:read', 'users:write', 'products:read', 'products:write', 'settings'],\n  USER: ['dashboard', 'products:read'],\n  GUEST: ['dashboard']\n};\nexport const hasPermission = (userRole, permission) => {\n  // If no user role, deny access\n  if (!userRole) return false;\n\n  // If role doesn't exist in our roles object, deny access\n  if (!roles[userRole]) return false;\n\n  // If role has wildcard (*), grant all permissions\n  if (roles[userRole].includes('*')) return true;\n\n  // Check if role has the specific permission\n  return roles[userRole].includes(permission);\n};\nexport const canAccessPage = (userRole, page) => {\n  // Page to permission mapping\n  const pagePermissions = {\n    dashboard: 'dashboard',\n    users: 'users:read',\n    products: 'products:read',\n    settings: 'settings'\n  };\n\n  // Always allow dashboard for any authenticated user\n  if (page === 'dashboard') return true;\n\n  // Get the required permission for this page\n  const requiredPermission = pagePermissions[page];\n\n  // If page doesn't require specific permission, allow access\n  if (!requiredPermission) return true;\n\n  // Check if user has the required permission\n  return hasPermission(userRole, requiredPermission);\n};\n\n// Additional utility functions\nexport const getUserPermissions = userRole => {\n  if (!userRole || !roles[userRole]) return [];\n  if (roles[userRole].includes('*')) {\n    return ['all_permissions'];\n  }\n  return roles[userRole];\n};\nexport const canPerformAction = (userRole, resource, action) => {\n  const permission = `${resource}:${action}`;\n  return hasPermission(userRole, permission);\n};\n\n// Default role for new users\nexport const getDefaultRole = () => 'ADMIN';\n\n// Role hierarchy for privilege escalation checks\nexport const roleHierarchy = {\n  SUPER_ADMIN: 4,\n  ADMIN: 3,\n  MANAGER: 2,\n  USER: 1,\n  GUEST: 0\n};\nexport const canManageRole = (currentUserRole, targetRole) => {\n  const currentLevel = roleHierarchy[currentUserRole] || 0;\n  const targetLevel = roleHierarchy[targetRole] || 0;\n  return currentLevel > targetLevel;\n};","map":{"version":3,"names":["roles","SUPER_ADMIN","ADMIN","MANAGER","USER","GUEST","hasPermission","userRole","permission","includes","canAccessPage","page","pagePermissions","dashboard","users","products","settings","requiredPermission","getUserPermissions","canPerformAction","resource","action","getDefaultRole","roleHierarchy","canManageRole","currentUserRole","targetRole","currentLevel","targetLevel"],"sources":["C:/Users/rksid/OneDrive/Documents/Desktop/Smart-Dashboard-System/src/utils/rbac.js"],"sourcesContent":["// src/utils/rbac.js\r\n\r\nexport const roles = {\r\n  SUPER_ADMIN: ['*'], // Full access to everything\r\n  ADMIN: ['*'], // Full access to everything\r\n  MANAGER: [\r\n    'dashboard', \r\n    'users:read', \r\n    'users:write', \r\n    'products:read', \r\n    'products:write', \r\n    'settings'\r\n  ],\r\n  USER: [\r\n    'dashboard', \r\n    'products:read'\r\n  ],\r\n  GUEST: [\r\n    'dashboard'\r\n  ]\r\n};\r\n\r\nexport const hasPermission = (userRole, permission) => {\r\n  // If no user role, deny access\r\n  if (!userRole) return false;\r\n  \r\n  // If role doesn't exist in our roles object, deny access\r\n  if (!roles[userRole]) return false;\r\n  \r\n  // If role has wildcard (*), grant all permissions\r\n  if (roles[userRole].includes('*')) return true;\r\n  \r\n  // Check if role has the specific permission\r\n  return roles[userRole].includes(permission);\r\n};\r\n\r\nexport const canAccessPage = (userRole, page) => {\r\n  // Page to permission mapping\r\n  const pagePermissions = {\r\n    dashboard: 'dashboard',\r\n    users: 'users:read',\r\n    products: 'products:read', \r\n    settings: 'settings'\r\n  };\r\n  \r\n  // Always allow dashboard for any authenticated user\r\n  if (page === 'dashboard') return true;\r\n  \r\n  // Get the required permission for this page\r\n  const requiredPermission = pagePermissions[page];\r\n  \r\n  // If page doesn't require specific permission, allow access\r\n  if (!requiredPermission) return true;\r\n  \r\n  // Check if user has the required permission\r\n  return hasPermission(userRole, requiredPermission);\r\n};\r\n\r\n// Additional utility functions\r\nexport const getUserPermissions = (userRole) => {\r\n  if (!userRole || !roles[userRole]) return [];\r\n  \r\n  if (roles[userRole].includes('*')) {\r\n    return ['all_permissions'];\r\n  }\r\n  \r\n  return roles[userRole];\r\n};\r\n\r\nexport const canPerformAction = (userRole, resource, action) => {\r\n  const permission = `${resource}:${action}`;\r\n  return hasPermission(userRole, permission);\r\n};\r\n\r\n// Default role for new users\r\nexport const getDefaultRole = () => 'ADMIN';\r\n\r\n// Role hierarchy for privilege escalation checks\r\nexport const roleHierarchy = {\r\n  SUPER_ADMIN: 4,\r\n  ADMIN: 3,\r\n  MANAGER: 2,\r\n  USER: 1,\r\n  GUEST: 0\r\n};\r\n\r\nexport const canManageRole = (currentUserRole, targetRole) => {\r\n  const currentLevel = roleHierarchy[currentUserRole] || 0;\r\n  const targetLevel = roleHierarchy[targetRole] || 0;\r\n  \r\n  return currentLevel > targetLevel;\r\n};"],"mappings":"AAAA;;AAEA,OAAO,MAAMA,KAAK,GAAG;EACnBC,WAAW,EAAE,CAAC,GAAG,CAAC;EAAE;EACpBC,KAAK,EAAE,CAAC,GAAG,CAAC;EAAE;EACdC,OAAO,EAAE,CACP,WAAW,EACX,YAAY,EACZ,aAAa,EACb,eAAe,EACf,gBAAgB,EAChB,UAAU,CACX;EACDC,IAAI,EAAE,CACJ,WAAW,EACX,eAAe,CAChB;EACDC,KAAK,EAAE,CACL,WAAW;AAEf,CAAC;AAED,OAAO,MAAMC,aAAa,GAAGA,CAACC,QAAQ,EAAEC,UAAU,KAAK;EACrD;EACA,IAAI,CAACD,QAAQ,EAAE,OAAO,KAAK;;EAE3B;EACA,IAAI,CAACP,KAAK,CAACO,QAAQ,CAAC,EAAE,OAAO,KAAK;;EAElC;EACA,IAAIP,KAAK,CAACO,QAAQ,CAAC,CAACE,QAAQ,CAAC,GAAG,CAAC,EAAE,OAAO,IAAI;;EAE9C;EACA,OAAOT,KAAK,CAACO,QAAQ,CAAC,CAACE,QAAQ,CAACD,UAAU,CAAC;AAC7C,CAAC;AAED,OAAO,MAAME,aAAa,GAAGA,CAACH,QAAQ,EAAEI,IAAI,KAAK;EAC/C;EACA,MAAMC,eAAe,GAAG;IACtBC,SAAS,EAAE,WAAW;IACtBC,KAAK,EAAE,YAAY;IACnBC,QAAQ,EAAE,eAAe;IACzBC,QAAQ,EAAE;EACZ,CAAC;;EAED;EACA,IAAIL,IAAI,KAAK,WAAW,EAAE,OAAO,IAAI;;EAErC;EACA,MAAMM,kBAAkB,GAAGL,eAAe,CAACD,IAAI,CAAC;;EAEhD;EACA,IAAI,CAACM,kBAAkB,EAAE,OAAO,IAAI;;EAEpC;EACA,OAAOX,aAAa,CAACC,QAAQ,EAAEU,kBAAkB,CAAC;AACpD,CAAC;;AAED;AACA,OAAO,MAAMC,kBAAkB,GAAIX,QAAQ,IAAK;EAC9C,IAAI,CAACA,QAAQ,IAAI,CAACP,KAAK,CAACO,QAAQ,CAAC,EAAE,OAAO,EAAE;EAE5C,IAAIP,KAAK,CAACO,QAAQ,CAAC,CAACE,QAAQ,CAAC,GAAG,CAAC,EAAE;IACjC,OAAO,CAAC,iBAAiB,CAAC;EAC5B;EAEA,OAAOT,KAAK,CAACO,QAAQ,CAAC;AACxB,CAAC;AAED,OAAO,MAAMY,gBAAgB,GAAGA,CAACZ,QAAQ,EAAEa,QAAQ,EAAEC,MAAM,KAAK;EAC9D,MAAMb,UAAU,GAAG,GAAGY,QAAQ,IAAIC,MAAM,EAAE;EAC1C,OAAOf,aAAa,CAACC,QAAQ,EAAEC,UAAU,CAAC;AAC5C,CAAC;;AAED;AACA,OAAO,MAAMc,cAAc,GAAGA,CAAA,KAAM,OAAO;;AAE3C;AACA,OAAO,MAAMC,aAAa,GAAG;EAC3BtB,WAAW,EAAE,CAAC;EACdC,KAAK,EAAE,CAAC;EACRC,OAAO,EAAE,CAAC;EACVC,IAAI,EAAE,CAAC;EACPC,KAAK,EAAE;AACT,CAAC;AAED,OAAO,MAAMmB,aAAa,GAAGA,CAACC,eAAe,EAAEC,UAAU,KAAK;EAC5D,MAAMC,YAAY,GAAGJ,aAAa,CAACE,eAAe,CAAC,IAAI,CAAC;EACxD,MAAMG,WAAW,GAAGL,aAAa,CAACG,UAAU,CAAC,IAAI,CAAC;EAElD,OAAOC,YAAY,GAAGC,WAAW;AACnC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}